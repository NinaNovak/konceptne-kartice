SELECT konceptna_kartica.id AS ID,
       naslov_kartice AS naslov,
       replace(group_concat(distinct kljucna_beseda.beseda), ",", ", ") AS kljucne,
       replace(group_concat(distinct programsko_orodje_ali_jezik.ime_orodja), ",", ", ") AS orodja
  FROM konceptna_kartica
       JOIN
       povezovalna_tabela_konceptna_kartica_x_kljucna_beseda ON konceptna_kartica.id = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_konceptne_kartice
       JOIN
       kljucna_beseda ON kljucna_beseda.id = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_kljucne_besede
       JOIN
       povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik ON konceptna_kartica.id = povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_konceptne_kartice
       JOIN
       programsko_orodje_ali_jezik ON povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_programskega_orodja_ali_jezika = programsko_orodje_ali_jezik.id
group by konceptna_kartica.id;

CREATE TABLE test_tabela (
  column1, 
  column2, 
  column3, 
  PRIMARY KEY (column1, column2)
);

SELECT konceptna_kartica.id
    
    FROM konceptna_kartica
    JOIN povezovalna_tabela_konceptna_kartica_x_kljucna_beseda
    ON konceptna_kartica.id
    = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_konceptne_kartice
    JOIN kljucna_beseda
    ON kljucna_beseda.id
    = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_kljucne_besede
    JOIN povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik
    ON povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_konceptne_kartice
    = konceptna_kartica.id
    JOIN programsko_orodje_ali_jezik
    ON programsko_orodje_ali_jezik.id
    = povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_programskega_orodja_ali_jezika
    WHERE

    konceptna_kartica.naslov_kartice            LIKE '%' || '001' || '%'
    OR konceptna_kartica.ime_datoteke           LIKE '%' || '001' || '%'
    OR kljucna_beseda.beseda                    LIKE '%' || '001' || '%'
    OR programsko_orodje_ali_jezik.ime_orodja   LIKE '%' || '001' || '%'
    OR 

    

    konceptna_kartica.naslov_kartice            LIKE '%' || 'plot' || '%'
    OR konceptna_kartica.ime_datoteke           LIKE '%' || 'plot' || '%'
    OR kljucna_beseda.beseda                    LIKE '%' || 'plot' || '%'
    OR programsko_orodje_ali_jezik.ime_orodja   LIKE '%' || 'plot' || '%';
 

    SELECT konceptna_kartica.id,
           naslov_kartice
           || ime_datoteke || ' '
           || replace(group_concat(distinct beseda), ",", " ")
           || replace(group_concat(distinct ime_orodja), ",", " ")

    AS naslov_kartice_in_vse_kljucne_in_vsi_jeziki

    FROM konceptna_kartica
       JOIN
       povezovalna_tabela_konceptna_kartica_x_kljucna_beseda
       ON
       konceptna_kartica.id
       = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_konceptne_kartice
       JOIN
       kljucna_beseda
       ON
       kljucna_beseda.id
       = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_kljucne_besede
       JOIN
       povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik ON konceptna_kartica.id
       = povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_konceptne_kartice
       JOIN
       programsko_orodje_ali_jezik
       ON
       povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_programskega_orodja_ali_jezika
       = programsko_orodje_ali_jezik.id

       

    
    WHERE naslov_kartice_in_vse_kljucne_in_vsi_jeziki LIKE '% ' || '001' || ' %'  --prva iskalna beseda
    OR    naslov_kartice_in_vse_kljucne_in_vsi_jeziki LIKE '% ' || 'plot' || ' %'  --druga iskalna beseda

    GROUP BY konceptna_kartica.id

;

SELECT konceptna_kartica.id AS ID,
       naslov_kartice AS naslov,
       replace(group_concat(distinct kljucna_beseda.beseda), ",", ", ") AS kljucne,
       replace(group_concat(distinct programsko_orodje_ali_jezik.ime_orodja), ",", ", ") AS orodja
       FROM konceptna_kartica
       JOIN
       povezovalna_tabela_konceptna_kartica_x_kljucna_beseda
       ON
       konceptna_kartica.id
       = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_konceptne_kartice
       JOIN
       kljucna_beseda
       ON
       kljucna_beseda.id
       = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_kljucne_besede
       JOIN
       povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik ON konceptna_kartica.id
       = povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_konceptne_kartice
       JOIN
       programsko_orodje_ali_jezik
       ON
       povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_programskega_orodja_ali_jezika
       = programsko_orodje_ali_jezik.id
       
WHERE konceptna_kartica.id IN
-------------------------------------------------------------------------
(SELECT id_konceptne FROM   
--------------------------------------------------------------------------
    (SELECT konceptna_kartica.id AS id_konceptne,

              ' '
           || naslov_kartice
           || ' '
           || replace(group_concat(distinct beseda), ",", " ")
           || ' '
           || replace(group_concat(distinct ime_orodja), ",", " ")
           || ' '

    AS naslov_kartice_in_vse_kljucne_in_vsi_jeziki

    FROM konceptna_kartica
       JOIN
       povezovalna_tabela_konceptna_kartica_x_kljucna_beseda
       ON
       konceptna_kartica.id
       = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_konceptne_kartice
       JOIN
       kljucna_beseda
       ON
       kljucna_beseda.id
       = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_kljucne_besede
       JOIN
       povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik ON konceptna_kartica.id
       = povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_konceptne_kartice
       JOIN
       programsko_orodje_ali_jezik
       ON
       povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_programskega_orodja_ali_jezika
       = programsko_orodje_ali_jezik.id

    GROUP BY konceptna_kartica.id
    
    )
--------------------------------------------konec SELECT-a
       JOIN
       povezovalna_tabela_konceptna_kartica_x_kljucna_beseda
       ON
       konceptna_kartica.id
       = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_konceptne_kartice
       JOIN
       kljucna_beseda
       ON
       kljucna_beseda.id
       = povezovalna_tabela_konceptna_kartica_x_kljucna_beseda.id_kljucne_besede
       JOIN
       povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik ON konceptna_kartica.id
       = povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_konceptne_kartice
       JOIN programsko_orodje_ali_jezik
       ON povezovalna_tabela_konceptna_kartica_x_programsko_orodje_ali_jezik.id_programskega_orodja_ali_jezika = programsko_orodje_ali_jezik.id
    
WHERE naslov_kartice_in_vse_kljucne_in_vsi_jeziki LIKE '% ' || 'turtle' || ' %'  --prva iskalna beseda
OR    naslov_kartice_in_vse_kljucne_in_vsi_jeziki LIKE '% ' || 'octave' || ' %'  --druga iskalna beseda

)

-----------------------------------------------konec SELECTa

GROUP BY konceptna_kartica.id

;